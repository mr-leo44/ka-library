# ============================================
# KA-LIBRARY - API Configuration
# ============================================

# --------------------------------------------
# Application
# --------------------------------------------
NODE_ENV=development
PORT=3333
HOST=0.0.0.0
APP_KEY=                                    # Generate: node ace generate:key
APP_NAME=ka-library
APP_URL=http://localhost:3333

# --------------------------------------------
# Database (PostgreSQL)
# --------------------------------------------
DB_CONNECTION=postgres
DB_HOST=127.0.0.1
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=
DB_DATABASE=ka_library

# Connection Pool
DB_POOL_MIN=2
DB_POOL_MAX=10

# --------------------------------------------
# Authentication & Security (OWASP Compliant)
# --------------------------------------------

# Access Tokens
AUTH_GUARD=access_tokens

# JWT Configuration
JWT_SECRET=                                 # Generate: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_ACCESS_TOKEN_EXPIRES_IN=15m            # Short-lived for security
JWT_REFRESH_TOKEN_EXPIRES_IN=7d            # Long-lived

# Password Policy (OWASP)
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL_CHARS=true

# Session Security
SESSION_DRIVER=cookie
SESSION_COOKIE_NAME=ka_library_session
SESSION_SECURE=true                         # true in production
SESSION_SAME_SITE=strict
SESSION_HTTP_ONLY=true

# --------------------------------------------
# Rate Limiting (OWASP A04)
# --------------------------------------------
RATE_LIMIT_ENABLED=true
RATE_LIMIT_GLOBAL=100                       # requests per minute globally
RATE_LIMIT_AUTH_LOGIN=5                     # login attempts per 15min per IP
RATE_LIMIT_AUTH_REGISTER=3                  # registrations per hour per IP
RATE_LIMIT_API_PER_USER=60                  # API calls per minute per user

# --------------------------------------------
# CORS Configuration
# --------------------------------------------
CORS_ENABLED=true
CORS_ORIGIN=http://localhost:3000           # Your frontend URL
CORS_METHODS=GET,HEAD,PUT,PATCH,POST,DELETE
CORS_HEADERS=Content-Type,Accept,Authorization
CORS_CREDENTIALS=true
CORS_MAX_AGE=86400

# --------------------------------------------
# Email Service (for verification, password reset)
# --------------------------------------------
SMTP_HOST=smtp.mailtrap.io                  # Development
SMTP_PORT=2525
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=noreply@ka-library.org
SMTP_FROM_NAME=KA Library

# Email Verification
EMAIL_VERIFICATION_REQUIRED=true
EMAIL_VERIFICATION_EXPIRES_IN=24h

# Password Reset
PASSWORD_RESET_TOKEN_EXPIRES_IN=1h

# --------------------------------------------
# Logging & Monitoring (OWASP A09)
# --------------------------------------------
LOG_LEVEL=info                              # debug, info, warn, error
LOG_ENABLED=true

# Security Logging
SECURITY_LOG_ENABLED=true
SECURITY_LOG_FAILED_LOGINS=true
SECURITY_LOG_SUSPICIOUS_ACTIVITY=true

# Audit Logging
AUDIT_LOG_ENABLED=true
AUDIT_LOG_RETENTION_DAYS=90

# --------------------------------------------
# File Upload (if needed later)
# --------------------------------------------
MAX_FILE_SIZE=5242880                       # 5MB in bytes
ALLOWED_FILE_TYPES=pdf,doc,docx,jpg,jpeg,png

# --------------------------------------------
# Cache (Redis - optional but recommended)
# --------------------------------------------
CACHE_DRIVER=redis
REDIS_HOST=127.0.0.1
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# --------------------------------------------
# Queue (for async jobs - email, notifications)
# --------------------------------------------
QUEUE_CONNECTION=redis

# --------------------------------------------
# Security Headers (OWASP)
# --------------------------------------------
# Helmet.js configuration
HELMET_ENABLED=true
CSP_ENABLED=true
HSTS_ENABLED=true
HSTS_MAX_AGE=31536000

# --------------------------------------------
# API Versioning
# --------------------------------------------
API_VERSION=v1
API_PREFIX=/api

# --------------------------------------------
# Development Tools
# --------------------------------------------
# Disable in production
DEBUG=false
PRETTY_PRINT_JSON=true

# --------------------------------------------
# Monitoring & Analytics (Optional)
# --------------------------------------------
SENTRY_DSN=                                 # Error tracking
SENTRY_ENVIRONMENT=development

# --------------------------------------------
# Feature Flags
# --------------------------------------------
FEATURE_EMAIL_VERIFICATION=true
FEATURE_TWO_FACTOR_AUTH=false               # Future feature
FEATURE_SOCIAL_LOGIN=false                  # Future feature